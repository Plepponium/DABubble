<div class="chats">
    <div class="header">
        <div class="header-inner-container">
            <div class="header-left" (click)="openDialogChannelDescription()">
                <div class="channel-name-container">
                    <img class="hover-icon" src="assets/icons/tag.svg" alt="">
                    <img class="hover-icon-purple" src="assets/icons/tag-purple.svg" alt="">
                    <div id="channel-name" class="font-24 font-w-700">{{ channelName }}</div>
                </div>
                <img class="hover-icon" src="assets/icons/expand_more.svg" alt="">
                <img class="hover-icon-purple" src="assets/icons/expand_more-purple.svg" alt="">
            </div>

            <div class="header-right">
                <div (click)="openDialogueShowUser()" class="users-display"
                    [ngClass]="{'users-display-active': usersDisplayActive}">
                    <div class="user-pics">
                        <div class="img-box" *ngFor="let user of participants | slice:0:3">
                            <img [src]="'/assets/user-icons/' + user.img + '.svg'" [alt]="user.name">
                        </div>
                    </div>
                    <div class="user-counter">{{ participants.length }}</div>
                </div>

                <app-round-btn (click)="openDialogueAddUser()" style="--btn-bg: #eceefe;"
                    iconSrc="assets/icons/person_add.svg" iconHoverSrc="assets/icons/person_add-purple.svg"
                    altText="Senden">
                </app-round-btn>
            </div>
        </div>

        <div (click)="closeDialogueShowUser(); closeDialogueAddUser(); closeDialogChannelDescription()"
            *ngIf="showUserDialogue || showAddDialogue || showChannelDescription" class="dialogue-backdrop">
        </div>
        <div class="overlay-box" [ngClass]="{'overlay-channel-description': showChannelDescription}">
            <app-dialogue-overlay *ngIf="showUserDialogue" (close)="closeDialogueShowUser()"
                (openProfile)="openDialogueShowProfile()" (openAddUser)="openDialogueAddUser()"
                class="dialogue-overlay-show-user">
            </app-dialogue-overlay>

            <app-chat-add-user-overlay *ngIf="showAddDialogue" (close)="closeDialogueAddUser()"
                class="dialogue-overlay-add-user">
            </app-chat-add-user-overlay>

            <app-channel-description-overlay *ngIf="showChannelDescription" (close)="closeDialogChannelDescription()"
                [channelId]="channelId">
            </app-channel-description-overlay>
        </div>

        <div (click)="closeDialogueShowProfile()" *ngIf="showProfileDialogue" class="dialogue-backdrop-profile"></div>
        <app-profile-overlay *ngIf="showProfileDialogue" (close)="closeDialogueShowProfile()"
            class="dialogue-overlay-show-profile">
        </app-profile-overlay>
    </div>

    <div class="chat-content">
        <div class="chat-history">

            <!-- <div *ngFor="let chat of channelChats" class="chat-day-section"> -->
            <!-- <div class="chat-day-section"> -->
                <!-- <div class="chat-date-section">
                    <div class="chat-date">Dienstag, 14. Januar</div>
                </div>
                <div class="chat-section">
                    <div class="chat-dialogue">
                        <button class="add-reaction-btn">
                            <img class="" src="assets/reaction-icons/check.svg" alt="">
                        </button>
                        <button class="add-reaction-btn">
                            <img class="" src="assets/reaction-icons/thumb.svg" alt="">
                        </button>
                        <button class="add-reaction-btn">
                            <img class="hover-icon" src="assets/message-icons/add_reaction.svg" alt="">
                            <img class="hover-icon-purple" src="assets/message-icons/add_reaction-purple.svg" alt="">
                        </button>
                        <button class="add-reaction-btn">
                            <img class="hover-icon" src="assets/icons/comment.svg" alt="">
                            <img class="hover-icon-purple" src="assets/icons/comment-purple.svg" alt="">
                        </button>
                        <div class="edit-comment-container">
                            <div class="edit-comment-dialogue" *ngIf="editCommentDialogueExpanded">
                                <div class="edit-comment">Nachricht bearbeiten</div>
                            </div>
                            <button (click)="openEditCommentDialogue()" class="add-reaction-btn reverse">
                                <img class="hover-icon" src="assets/message-icons/more_vert.svg" alt="">
                                <img class="hover-icon-purple" src="assets/message-icons/more_vert-purple.svg" alt="">
                            </button>
                        </div>
                    </div>
                    <img class="chat-user-img" src="assets/user-icons/icon4.svg" alt="">

                    <div class="chat-info-container">
                        <div class="chat-start">
                            <div class="font-w-700">Noah Braun</div>
                            <div class="font-14 t-gray">14:25 Uhr</div>
                        </div>
                        <div class="chat-message left bg-light-purple">Chat</div>
                        <div class="chat-answered">
                            <div class="answers">
                                <div (click)="handleOpenThread()" class="answer t-purple">2 Antworten</div>
                                <div class="last-answer font-14 t-gray">Letzte Antwort 14:56</div>
                            </div>
                            <div class="reactions">
                                <div class="reaction-btns">
                                    <div class="reaction-btn">
                                        <img src="assets/reaction-icons/check.svg" alt="">
                                        <div>2</div>
                                    </div>
                                    <div class="reaction-btn">
                                        <img src="assets/reaction-icons/thumb.svg" alt="">
                                        <div>1</div>
                                    </div>
                                </div>
                                <app-round-btn iconSrc="assets/message-icons/add_reaction.svg"
                                    iconHoverSrc="assets/message-icons/add_reaction-purple.svg"
                                    altText="Reaktion hinzufügen">
                                </app-round-btn>
                            </div>
                        </div>
                    </div>
                </div>
            </div> -->

            <div *ngFor="let chat of channelChats; let i = index" class="chat-day-section" [ngClass]="{'reverse': chat.user === currentUserId}">
                <div class="chat-date-section">
                    <div class="chat-date">{{ chat.time * 1000 | date: 'EEEE, d. MMMM':'':'de' }}</div>
                </div>
                <div class="chat-section" [ngClass]="{'reverse': chat.user === currentUserId}">
                    <div class="chat-dialogue" [ngClass]="{'reverse': chat.user === currentUserId}">
                        <button class="add-reaction-btn">
                            <img class="" src="assets/reaction-icons/check.svg" alt="">
                        </button>
                        <button class="add-reaction-btn">
                            <img class="" src="assets/reaction-icons/thumb.svg" alt="">
                        </button>
                        <button class="add-reaction-btn">
                            <img class="hover-icon" src="assets/message-icons/add_reaction.svg" alt="">
                            <img class="hover-icon-purple" src="assets/message-icons/add_reaction-purple.svg" alt="">
                        </button>
                        <button class="add-reaction-btn">
                            <img class="hover-icon" src="assets/icons/comment.svg" alt="">
                            <img class="hover-icon-purple" src="assets/icons/comment-purple.svg" alt="">
                        </button>
                        <div class="edit-comment-container">
                            <div class="edit-comment-dialogue" *ngIf="editCommentDialogueExpanded">
                                <div class="edit-comment">Nachricht bearbeiten</div>
                            </div>
                            <button (click)="openEditCommentDialogue()" class="add-reaction-btn reverse">
                                <img class="hover-icon" src="assets/message-icons/more_vert.svg" alt="">
                                <img class="hover-icon-purple" src="assets/message-icons/more_vert-purple.svg" alt="">
                            </button>
                        </div>
                    </div>

                    <img class="chat-user-img" [src]="'assets/user-icons/' + chat.userImg + '.svg'" [alt]="chat.userName">

                    <div class="chat-info-container">
                        <div class="chat-start" [ngClass]="{'reverse': chat.user === currentUserId}">
                            <div class="font-w-700">{{ chat.userName }}</div>
                            <div class="font-14 t-gray">{{ chat.time * 1000 | date: 'HH:mm' }} Uhr</div>
                        </div>
                        <div class="chat-message" [ngClass]="{'left bg-light-purple': chat.user !== currentUserId, 'right': chat.user === currentUserId}">{{ chat.message }}</div>
                        <div class="chat-answered" [ngClass]="{'right': chat.user === currentUserId}">
                            <div class="answers" *ngIf="chat.answersCount && chat.answersCount > 0">
                                <div (click)="handleOpenThread()" class="answer t-purple">{{ chat.answersCount }} Antworten</div>
                                <div class="last-answer font-14 t-gray">Letzte Antwort {{ (chat.lastAnswerTime * 1000) | date: 'HH:mm' }}</div>
                            </div>
                            <div class="reactions">
                                <div class="reaction-btns">
                                    <div (click)="toggleReaction(i, reaction.type)" *ngFor="let reaction of chat.reactionArray" class="reaction-btn" [ngClass]="{'reacted': reaction.currentUserReacted}">
                                        <img [src]="'assets/reaction-icons/' + reaction.type + '.svg'" [alt]="reaction.type">
                                        <div>{{ reaction.count }}</div>

                                        <div class="r-btn-hover-display">
                                            <div class="r-btn-hover-display-content">
                                                <img [src]="'assets/reaction-icons/' + reaction.type + '.svg'" [alt]="reaction.type">
                                                <div class="reaction-btn-t-box no-wrap">
                                                    <div *ngIf="reaction.currentUserReacted && reaction.otherUserName && reaction.count <= 2" class="font-w-700">
                                                        {{ reaction.otherUserName }} und Du
                                                    </div>
                                                    <div *ngIf="reaction.currentUserReacted && reaction.otherUserName && reaction.count > 2" class="font-w-700">
                                                        {{ reaction.otherUserName }}, Du
                                                    </div>
                                                    <div *ngIf="!reaction.currentUserReacted && reaction.otherUserName" class="font-w-700">
                                                        {{ reaction.otherUserName }}
                                                    </div>
                                                    <div *ngIf="reaction.currentUserReacted && !reaction.otherUserName" class="font-w-700">
                                                        Du
                                                    </div>
                                                    <span *ngIf="reaction.count === 1 && reaction.currentUserReacted">hast reagiert</span>
                                                    <span *ngIf="reaction.count === 1 && !reaction.currentUserReacted">hat reagiert</span>
                                                    <span *ngIf="reaction.count - (reaction.currentUserReacted ? 1 : 0) >= 2" class="font-w-700">und andere</span>
                                                    <span *ngIf="reaction.count > 1">haben reagiert</span>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- <pre>{{ reaction | json }}</pre> -->
                                    </div>
                                    <!-- <div class="reaction-btn">
                                        <img src="assets/reaction-icons/check.svg" alt="">
                                        <div>2</div>
                                    </div>
                                    <div class="reaction-btn">
                                        <img src="assets/reaction-icons/thumb.svg" alt="">
                                        <div>1</div>
                                    </div> -->
                                </div>
                                <app-round-btn iconSrc="assets/message-icons/add_reaction.svg"
                                    iconHoverSrc="assets/message-icons/add_reaction-purple.svg"
                                    altText="Reaktion hinzufügen">
                                </app-round-btn>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- <pre>{{ channelChats | json }}</pre> -->
            

            <!-- <div class="chat-day-section">
                <div class="chat-date-section">
                    <div class="chat-date">Freitag, 1.September</div>
                </div>

                <div class="chat-section reverse">
                    <div class="chat-dialogue reverse">
                        <button class="add-reaction-btn">
                            <img class="" src="assets/reaction-icons/check.svg" alt="">
                        </button>
                        <button class="add-reaction-btn">
                            <img class="" src="assets/reaction-icons/thumb.svg" alt="">
                        </button>
                        <button class="add-reaction-btn">
                            <img class="hover-icon" src="assets/message-icons/add_reaction.svg" alt="">
                            <img class="hover-icon-purple" src="assets/message-icons/add_reaction-purple.svg" alt="">
                        </button>
                        <button class="add-reaction-btn">
                            <img class="hover-icon" src="assets/icons/comment.svg" alt="">
                            <img class="hover-icon-purple" src="assets/icons/comment-purple.svg" alt="">
                        </button>
                        <div class="edit-comment-container">
                            <div class="edit-comment-dialogue" *ngIf="editCommentDialogueExpanded">
                                <div class="edit-comment">Nachricht bearbeiten</div>
                            </div>
                            <button (click)="openEditCommentDialogue()" class="add-reaction-btn reverse">
                                <img class="hover-icon" src="assets/message-icons/more_vert.svg" alt="">
                                <img class="hover-icon-purple" src="assets/message-icons/more_vert-purple.svg" alt="">
                            </button>
                        </div>

                    </div>
                    <img class="chat-user-img" src="assets/user-icons/icon3.svg" alt="">

                    <div class="chat-info-container">
                        <div class="chat-start reverse">
                            <div class="font-w-700">Frederik Beck</div>
                            <div class="font-14 t-gray">15:06 Uhr</div>
                        </div>
                        <div class="chat-message right">Lorem ipsum dolor sit amet consectetur adipisicing elit. Dolore
                            perspiciatis aliquid dolorem, porro maiores asperiores libero omnis. Est omnis hic placeat,
                            at eos pariatur corporis eaque quia quasi? Eos, quibusdam?</div>
                        <div class="chat-answered right">
                            <div class="answers">
                                <div class="answer t-purple">Antworten</div>
                                <div class="last-answer font-14 t-gray">letzte Antwort</div>
                            </div>
                            <div class="reactions">
                                <div class="reaction-btns">
                                    <div class="reaction-btn">
                                        <img src="assets/reaction-icons/check.svg" alt="">
                                        <div>2</div>
                                    </div>
                                    <div class="reaction-btn">
                                        <img src="assets/reaction-icons/thumb.svg" alt="">
                                        <div>1</div>
                                    </div>
                                </div>
                                <app-round-btn iconSrc="assets/message-icons/add_reaction.svg"
                                    iconHoverSrc="assets/message-icons/add_reaction-purple.svg"
                                    altText="Reaktion hinzufügen">
                                </app-round-btn>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div> -->

        <form class="form">
            <div class="form-field full-width">
                <textarea id="chat-message" class="input" name="" type="text" placeholder=" "></textarea>
                <label for="chat-message" class="floating-label t-gray">Nachricht an #Entwicklerteam</label>
                <div class="input-icon-bar">
                    <div class="icon-bar t-gray">
                        <app-round-btn iconSrc="assets/message-icons/sentiment_satisfied-gray.svg"
                            iconHoverSrc="assets/message-icons/sentiment_satisfied-purple.svg"
                            altText="Reaktion hinzufügen">
                        </app-round-btn>
                        <app-round-btn iconSrc="assets/message-icons/alternate_email-gray.svg"
                            iconHoverSrc="assets/message-icons/alternate_email-purple.svg" altText="Mail hinzufügen">
                        </app-round-btn>
                    </div>

                    <app-round-btn style="--btn-bg-hover: #ffffff;" iconSrc="assets/message-icons/send-purple.svg"
                        iconHoverSrc="assets/message-icons/send-purple2.svg" altText="Senden">
                    </app-round-btn>
                </div>
            </div>
        </form>

    </div>
</div>