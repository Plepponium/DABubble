<form class="form" (ngSubmit)="onFormSubmit(answerForm)" #answerForm="ngForm">
  <div class="form-field" (click)="focusInput($event)">
    <textarea
      #messageInput
      id="chat-input"
      class="input"
      name="message"
      [(ngModel)]="text"
      (ngModelChange)="textChange.emit($event)"
      (keydown.enter)="onEnterPress($any($event))"
      type="text"
      [placeholder]="placeholder"
      (input)="updateCaretPosition(messageInput)"
      (keyup)="updateCaretPosition(messageInput)"
    ></textarea>

    <app-smiley-overlay
      [active]="activeSmiley"
      [emojis]="emojis"
      (selected)="onSmileySelected($event)"
      (activeChange)="activeSmiley = $event">
    </app-smiley-overlay>

    <app-mentions-overlay
      [text]="text"
      [caretIndex]="mentionCaretIndex"
      [currentUserId]="currentUserId"
      [context]="'Channel'"
      [users]="users"
      [channels]="channels"
      (mentionSelected)="insertMention($event)"
      (overlayStateChange)="onOverlayStateChange($event)">
    </app-mentions-overlay>

    <div class="input-icon-bar">
      <div class="icon-bar t-gray">
        <app-round-btn
          iconSrc="assets/message-icons/sentiment_satisfied-gray.svg"
          iconHoverSrc="assets/message-icons/sentiment_satisfied-purple.svg"
          altText="Reaktion hinzufügen"
          [type]="'button'"
          (click)="openSmileyOverlay()">
        </app-round-btn>

        <app-round-btn
          iconSrc="assets/message-icons/alternate_email-gray.svg"
          iconHoverSrc="assets/message-icons/alternate_email-purple.svg"
          altText="Empfänger hinzufügen"
          [type]="'button'"
          (click)="insertAtCursor('@', messageInput)">
        </app-round-btn>
      </div>

      <app-round-btn
        style="--btn-bg-hover: #ffffff;"
        iconSrc="assets/message-icons/send-purple.svg"
        iconHoverSrc="assets/message-icons/send-purple2.svg"
        altText="Senden"
        type="submit">
      </app-round-btn>
    </div>
  </div>
</form>